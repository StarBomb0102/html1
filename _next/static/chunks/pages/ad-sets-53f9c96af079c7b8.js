(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[426],{2111:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ad-sets",function(){return a(46776)}])},46776:function(e,t,a){"use strict";a.r(t);var i=a(85893),n=a(67294),s=a(11163),l=a(41664),d=a.n(l),r=a(61953),o=a(29630),c=a(21448),u=a(72389),p=a(75084),m=a(49837),h=a(59742),x=a(14398),f=a(67836),g=a(91359),_=a(65824),b=a(62652),j=a(51514),Z=a(50196),y=a(30381),C=a.n(y),v=a(31705),w=a(51533),S=a(21609),k=a(87745),E=a(57332);let O=()=>{let e=(0,s.useRouter)(),{settings:t}=(0,j.r)(),{setLoading:a}=(0,v.O)(),[l,y]=(0,n.useState)(null),[O,T]=(0,n.useState)([]),[I,N]=(0,n.useState)(null),[z,D]=(0,n.useState)([]),[A,P]=(0,n.useState)(1),[H,W]=(0,n.useState)([]),[M,B]=(0,n.useState)(!1),[L,R]=(0,n.useState)(!1),[q,V]=(0,n.useState)(null),[U,Y]=(0,n.useState)(""),[K,X]=(0,n.useState)(!1),F=e=>{Y(e.id),X(!0)},G=e=>{switch(e){case void 0:default:return"Using ad set bid strategy";case"LOWEST_COST_WITH_BID_CAP":return"Bid cap";case"LOWEST_COST_WITHOUT_CAP":return"Highest Volumn";case"COST_CAP":return"Cost per result goal"}},$=e=>e.split("_").join(" ").toLowerCase(),J=e=>{switch(e){case"ACTIVE":return"success";case"ARCHIVED":return"warning";case"PAUSED":return"secondary";case"DELETED":return"error";default:return"primary"}},Q=e=>{V(e),R(!0)},ee=(0,n.useCallback)(async()=>{a(!0);let{data:i}=await Z.ZP.get("https://graph.facebook.com/v22.0/me/adaccounts",{params:{fields:"name,account_id",access_token:t.facebookApiKey,limit:1e5}});if(i.data.length){var n;T(i.data),(null===(n=e.query)||void 0===n?void 0:n.acc_id)?y(i.data.find(t=>t.account_id===e.query.acc_id)||(null==i?void 0:i.data[0])):y(i.data[0])}},[e.query]);(0,n.useEffect)(()=>{ee()},[ee]);let et=(0,n.useCallback)(async()=>{if(a(!0),l){let{data:i}=await Z.ZP.get("https://graph.facebook.com/v22.0/".concat(l.id,"/campaigns"),{params:{fields:"name,account_id,bid_strategy,budget_remaining,buying_type,daily_budget,is_budget_schedule_enabled,special_ad_category,status,created_time,objective,pacing_type,primary_attribution,smart_promotion_type",access_token:t.facebookApiKey,limit:1e3}});if(i.data){var n,s,d;D(i.data),(null===(n=e.query)||void 0===n?void 0:n.cmp_id)?N(i.data.find(t=>t.id===e.query.cmp_id)||(null==i?void 0:null===(s=i.data)||void 0===s?void 0:s[0])):N(null==i?void 0:null===(d=i.data)||void 0===d?void 0:d[0])}}},[l]);(0,n.useEffect)(()=>{et()},[et]);let ea=(0,n.useCallback)(async()=>{try{if(a(!0),I){let{data:e}=await Z.ZP.get("https://graph.facebook.com/v22.0/".concat(I.id,"/adsets"),{params:{fields:"name,bid_adjustments,bid_strategy,billing_event,optimization_goal,created_time,daily_budget,status",access_token:t.facebookApiKey,limit:1e3}});e.data&&W(e.data)}else W([]);P(1)}finally{a(!1)}},[I]);return(0,n.useEffect)(()=>{ea()},[ea]),(0,i.jsxs)(m.Z,{elevation:0,sx:{border:e=>"1px solid ".concat(e.palette.divider)},children:[(0,i.jsx)(h.Z,{title:"Ad Sets",action:(0,i.jsxs)(r.Z,{sx:{display:"flex",gap:"10px"},children:[(0,i.jsx)(x.Z,{size:"small",options:O,getOptionLabel:e=>e.name,renderOption:(e,t,a)=>(0,i.jsxs)(r.Z,{...e,sx:{width:"100%",flexDirection:"column",alignItems:"flex-start !important",backgroundColor:a.inputValue==t.name?"f0f0f0":"#ffffff"},children:[(0,i.jsx)(o.Z,{children:t.name}),(0,i.jsx)(o.Z,{variant:"caption",children:t.account_id})]}),renderInput:e=>(0,i.jsx)(f.Z,{size:"small",label:"Accounts",sx:{minWidth:350},...e}),value:l,onChange:(e,t)=>y(t)}),(0,i.jsx)(x.Z,{size:"small",options:z,getOptionLabel:e=>e.name,renderOption:(e,t,a)=>(0,i.jsxs)(r.Z,{...e,sx:{width:"100%",flexDirection:"column",alignItems:"flex-start !important",backgroundColor:a.inputValue==t.name?"f0f0f0":"#ffffff"},children:[(0,i.jsx)(o.Z,{children:t.name}),(0,i.jsx)(o.Z,{variant:"caption",children:t.id})]}),renderInput:e=>(0,i.jsx)(f.Z,{size:"small",label:"Campaigns",sx:{minWidth:350},...e}),value:I,onChange:(e,t)=>N(t)}),(0,i.jsx)(p.Z,{variant:"contained",startIcon:(0,i.jsx)(S.Z,{icon:"mdi:plus"}),sx:{textTransform:"capitalize"},onClick:()=>B(!0),children:"New Bid Multiplier"})]})}),(0,i.jsxs)(g.Z,{sx:{px:0,minHeight:525},children:[(0,i.jsx)(b._,{autoHeight:!0,getRowId:e=>e.id,getRowHeight:e=>"auto",columns:[{flex:1,minWidth:300,field:"name",headerName:"Name",renderCell(e){let{row:t}=e;return(0,i.jsxs)(r.Z,{children:[(0,i.jsx)(r.Z,{component:d(),href:"ads?adset_id=".concat(t.id),sx:{color:"#001c64",display:"block",textTransform:"capitalize",textDecoration:"none"},children:t.name}),(0,i.jsx)(o.Z,{variant:"caption",component:d(),href:"ads?adset_id=".concat(t.id),sx:{color:e=>e.palette.secondary.main},children:t.id})]})}},{width:210,field:"bid_strategy",headerName:"Bid Strategy",renderCell(e){let{row:t}=e;return(0,i.jsxs)(r.Z,{children:[(0,i.jsx)(r.Z,{children:G(t.bid_strategy)}),(0,i.jsx)(o.Z,{variant:"caption",sx:{textTransform:"capitalize"},children:$(t.optimization_goal)})]})}},{width:200,field:"budget",headerName:"Budget",renderCell(e){let{row:t}=e;return(0,i.jsx)(r.Z,{children:t.daily_budget?(0,i.jsxs)(r.Z,{children:[(0,i.jsxs)(r.Z,{children:["$",Number(t.daily_budget)/100]}),(0,i.jsx)(o.Z,{variant:"caption",children:"Daily"})]}):"Using campaign budget"})}},{width:120,field:"status",headerName:"Status",renderCell(e){let{row:t}=e;return(0,i.jsx)(c.Z,{label:t.status,color:J(t.status),size:"small",sx:{width:"100%"}})}},{width:185,field:"schedule",headerName:"Schedule",renderCell(e){let{row:t}=e;return C()(t.created_time).format("YYYY-MM-DD HH:mm:ss")}},{width:115,field:"action",headerName:"Action",renderCell(e){let{row:t}=e;return(0,i.jsxs)(r.Z,{sx:{display:"flex",gap:3},children:[(0,i.jsx)(u.Z,{title:"Details",children:(0,i.jsx)(p.Z,{variant:"outlined",color:"info",size:"small",sx:{minWidth:36,width:36,height:36,px:"0 !important"},onClick:()=>Q(t),children:(0,i.jsx)(S.Z,{icon:"mdi:eye-outline"})})}),(0,i.jsx)(u.Z,{title:"Edit",children:(0,i.jsx)(p.Z,{variant:"outlined",color:"success",size:"small",sx:{minWidth:36,width:36,height:36,px:"0 !important"},onClick:()=>F(t),children:(0,i.jsx)(S.Z,{icon:"bx:edit"})})})]})}}],rows:H,disableColumnMenu:!0,disableColumnSorting:!0,disableMultipleRowSelection:!0,disableRowSelectionOnClick:!0,page:A-1,pageSize:10,rowsPerPageOptions:[10],hideFooter:!0,lockColumn:0,sx:{"& .MuiDataGrid-cell":{py:"8px !important"},borderBottom:e=>"1px solid ".concat(e.palette.divider),mb:4}}),(0,i.jsx)(r.Z,{sx:{display:"flex",gap:2,alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(_.Z,{count:Math.ceil(H.length/10),page:A,onChange:(e,t)=>P(t),variant:"outlined",shape:"rounded"})})]}),(0,i.jsx)(k.Z,{account:l,campaign:I,adSet:q,open:L,onClose:()=>R(!1)}),(0,i.jsx)(w.Z,{open:M,account:l,campaign:I,onInit:ea,onClose:()=>B(!1)}),(0,i.jsx)(E.Z,{id:U,open:K,account:l,campaign:I,onInit:ea,onClose:()=>X(!1)})]})};t.default=O}},function(e){e.O(0,[885,794,755,976,836,957,72,534,291,915,774,888,179],function(){return e(e.s=2111)}),_N_E=e.O()}]);